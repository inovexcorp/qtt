#
# Password Encryption Service Configuration
#
# This service provides AES-256-GCM encryption for datasource passwords stored in the database.
# Configuration uses environment variables with sensible defaults for production security.
#

#
# Enable/Disable Password Encryption
#
# If disabled, passwords are stored in PLAIN TEXT in the database.
# RECOMMENDATION: Enable this in production environments with proper key management.
#
encryption.enabled=$[env:PASSWORD_ENCRYPTION_ENABLED;default=false]

#
# Encryption Key and Salt (REQUIRED if encryption is enabled)
#
# These values are used for PBKDF2 key derivation.
#
# SECURITY RECOMMENDATIONS:
# - Use environment variables in production (PASSWORD_ENCRYPTION_KEY, PASSWORD_ENCRYPTION_SALT)
# - Key should be at least 32 characters of random data
# - Salt should be at least 16 characters of random data
# - Never commit real keys to version control
# - Rotate keys periodically (requires re-encrypting all passwords)
#
# Example generation (Linux/Mac):
#   export PASSWORD_ENCRYPTION_KEY=$(openssl rand -base64 32)
#   export PASSWORD_ENCRYPTION_SALT=$(openssl rand -base64 16)
#
encryption.key=$[env:PASSWORD_ENCRYPTION_KEY;default=]
encryption.salt=$[env:PASSWORD_ENCRYPTION_SALT;default=]

#
# Advanced Encryption Parameters
#
# WARNING: Only modify these if you understand the cryptographic implications.
# Changing these values will make existing encrypted passwords unreadable.
#

# PBKDF2 iteration count for key derivation
# Higher values increase security but decrease performance
# Current OWASP recommendation: 600,000+ iterations for PBKDF2-HMAC-SHA256
# Default: 65536 (backward compatible with existing deployments)
pbkdf2.iterations=$[env:ENCRYPTION_PBKDF2_ITERATIONS;default=65536]

# Cipher algorithm specification
# Must be a valid Java Cipher transformation
# Default: AES/GCM/NoPadding (recommended for authenticated encryption)
algorithm=$[env:ENCRYPTION_ALGORITHM;default=AES/GCM/NoPadding]

# AES key length in bits
# Valid values: 128, 192, 256
# Default: 256 (maximum security, requires unlimited strength JCE)
key.length=$[env:ENCRYPTION_KEY_LENGTH;default=256]

# GCM authentication tag length in bits
# Valid values: 96, 104, 112, 120, 128
# Default: 128 (recommended)
gcm.tag.length=$[env:ENCRYPTION_GCM_TAG_LENGTH;default=128]

# GCM initialization vector (IV) length in bytes
# Must be 12 bytes for optimal GCM performance
# Default: 12 (NIST recommendation)
gcm.iv.length=$[env:ENCRYPTION_GCM_IV_LENGTH;default=12]

#
# Error Handling Behavior
#
# If true, encryption/decryption errors will cause operations to fail.
# If false (default), errors are logged and operations continue:
#   - Encryption failure: returns plaintext (logged as error)
#   - Decryption failure: returns ciphertext as-is (backward compatibility for plaintext passwords)
#
# RECOMMENDATION: Set to false for graceful degradation and backward compatibility.
#
fail.on.error=$[env:ENCRYPTION_FAIL_ON_ERROR;default=false]